# Вода Трекер - Water Intake Tracker PWA

## Обзор
Веб-приложение для отслеживания ежедневного потребления воды с поддержкой PWA (Progressive Web App). Приложение можно установить на домашний экран мобильного устройства и использовать в офлайн режиме.

## Основные возможности

### Реализовано в MVP
- **Дневная цель**: Настройка цели потребления воды (по умолчанию 3000 мл)
- **Быстрый ввод**: Предустановленные объемы (150, 200, 450, 850, 1000 мл) для быстрого добавления
- **Ручной ввод**: Возможность ввести произвольный объем воды
- **Визуальный прогресс**: Круговой индикатор с процентом выполнения дневной цели
- **История**: Интерактивный график потребления за последние 7 дней
- **Настройки**: 
  - Изменение дневной цели
  - Настройка предустановленных объемов
  - Добавление/удаление быстрых кнопок
- **PWA функциональность**:
  - Установка на домашний экран
  - Офлайн работа с кешированием
  - Адаптивный дизайн для мобильных устройств

### Планируется в будущем
- Расчет рекомендуемой нормы воды на основе роста и веса
- Push-уведомления с напоминаниями
- Расширенная статистика (средний объем за неделю/месяц, процент достижения цели)
- Экспорт данных в CSV/PDF
- Темная тема

## Технологический стек

### Frontend
- React + TypeScript
- TanStack Query для управления состоянием и кешированием
- Tailwind CSS для стилизации
- Shadcn UI компоненты
- Wouter для роутинга
- Recharts для графиков
- date-fns для работы с датами

### Backend
- Express.js
- In-memory storage (MemStorage)
- Zod для валидации

### PWA
- Service Worker для офлайн работы
- Web App Manifest для установки

## Структура проекта

```
├── client/
│   ├── src/
│   │   ├── components/       # Переиспользуемые компоненты
│   │   │   ├── DailyProgress.tsx
│   │   │   ├── QuickInputButtons.tsx
│   │   │   ├── ManualInput.tsx
│   │   │   ├── TodaysLog.tsx
│   │   │   ├── HistoryChart.tsx
│   │   │   ├── SettingsPanel.tsx
│   │   │   └── BottomNav.tsx
│   │   ├── pages/            # Страницы приложения
│   │   │   ├── Home.tsx
│   │   │   ├── History.tsx
│   │   │   └── Settings.tsx
│   │   ├── App.tsx
│   │   └── main.tsx
│   └── index.html
├── server/
│   ├── routes.ts             # API endpoints
│   └── storage.ts            # In-memory хранилище
├── shared/
│   └── schema.ts             # Общие типы и схемы
└── public/
    ├── manifest.json         # PWA манифест
    └── sw.js                 # Service Worker

## API Endpoints

### Записи о воде
- `GET /api/water-entries?date=YYYY-MM-DD` - Получить записи за день
- `POST /api/water-entries` - Добавить запись
- `DELETE /api/water-entries/:id` - Удалить запись

### Настройки
- `GET /api/settings` - Получить настройки
- `PUT /api/settings` - Обновить настройки

### История
- `GET /api/history?days=7` - Получить историю за N дней

## Схема данных

### WaterEntry
```typescript
{
  id: string;
  amount: number;      // объем в мл
  timestamp: Date;
  date: string;        // формат YYYY-MM-DD
}
```

### Settings
```typescript
{
  id: string;
  dailyGoal: number;         // цель в мл
  presetVolumes: string;     // "150,200,450,850,1000"
}
```

## Запуск приложения

```bash
npm install
npm run dev
```

Приложение доступно на `http://localhost:5000`

## PWA установка

1. Откройте приложение в браузере на мобильном устройстве
2. В меню браузера выберите "Добавить на главный экран"
3. Приложение будет установлено как нативное

## Офлайн работа

Приложение использует Service Worker для кеширования:
- Статические ресурсы (HTML, CSS, JS, иконки) - cache-first
- API запросы - network-first с fallback на кеш
- Навигация в офлайн режиме работает благодаря навигационному fallback

## Разработка

### Добавление новых функций
1. Обновить схему данных в `shared/schema.ts`
2. Добавить методы в `server/storage.ts`
3. Создать API endpoint в `server/routes.ts`
4. Создать/обновить компоненты в `client/src/components/`
5. Интегрировать в соответствующую страницу

### Тестирование
- End-to-end тесты с Playwright
- Тестирование офлайн режима в DevTools

## Changelog

### 2025-11-02 - MVP Release
- ✅ Базовый функционал отслеживания воды
- ✅ Визуальный прогресс
- ✅ История с графиком
- ✅ Настройки
- ✅ PWA с офлайн поддержкой
- ✅ Backend API с валидацией
- ✅ Error handling для всех операций

## Известные ограничения

- In-memory storage - данные теряются при перезапуске сервера
- История ограничена 7 днями
- Нет авторизации пользователей
- Нет синхронизации между устройствами

## Следующие шаги

1. Добавить PostgreSQL для персистентного хранения
2. Реализовать расчет рекомендуемой нормы
3. Добавить push-уведомления
4. Расширенная статистика
5. Темная тема
